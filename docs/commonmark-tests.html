
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>
            MarkAppend - CommonMark Tests
        </title>
        <link rel="icon" type="image/icon" href="images/favicon.svg" />
        <link rel="stylesheet" href="dist/normal.css" />
        
    </head>
    <body data-syntax-highlight="monokai"
        data-theme="purple-rain">
        
        <div id="navbar">
            
    <div class="navmenu ">
        
    <div class="navitem " >
        <a class="title enabled" href="index.html" >
            <img src="images/favicon.svg" />
            <span>MarkAppend</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://www.npmjs.com/package/markappend" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-npm" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M1 8h22v7h-12v2h-4v-2h-6z" />
            <path d="M7 8v7" />
            <path d="M14 8v7" />
            <path d="M17 11v4" />
            <path d="M4 11v4" />
            <path d="M11 11v1" />
            <path d="M20 11v4" />
        </svg>
            <span>Download</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://github.com/johtela/markappend" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
        </svg>
            <span>GitHub</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Syntax Highlight</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="coding-horror">
        <a   onclick="document.body.syntaxHighlight('coding-horror')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Coding Horror</span>
        </a>
        
    </div>
    <div class="navitem active" id="monokai">
        <a   onclick="document.body.syntaxHighlight('monokai')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Monokai</span>
        </a>
        
    </div>
    <div class="navitem " id="solarized-light">
        <a   onclick="document.body.syntaxHighlight('solarized-light')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Solarized Light</span>
        </a>
        
    </div>
    <div class="navitem " id="son-of-obsidian">
        <a   onclick="document.body.syntaxHighlight('son-of-obsidian')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Son of Obsidian</span>
        </a>
        
    </div>
    </div>
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Theme</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="blueberry">
        <a   onclick="document.body.theme('blueberry')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Blueberry</span>
        </a>
        
    </div>
    <div class="navitem " id="book-cover">
        <a   onclick="document.body.theme('book-cover')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Book Cover</span>
        </a>
        
    </div>
    <div class="navitem " id="brownie">
        <a   onclick="document.body.theme('brownie')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Brownie</span>
        </a>
        
    </div>
    <div class="navitem " id="camouflage">
        <a   onclick="document.body.theme('camouflage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Camouflage</span>
        </a>
        
    </div>
    <div class="navitem " id="chocolate">
        <a   onclick="document.body.theme('chocolate')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Chocolate</span>
        </a>
        
    </div>
    <div class="navitem " id="greyhound">
        <a   onclick="document.body.theme('greyhound')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Greyhound</span>
        </a>
        
    </div>
    <div class="navitem " id="ice-age">
        <a   onclick="document.body.theme('ice-age')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ice Age</span>
        </a>
        
    </div>
    <div class="navitem " id="mustard">
        <a   onclick="document.body.theme('mustard')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Mustard</span>
        </a>
        
    </div>
    <div class="navitem " id="peachy">
        <a   onclick="document.body.theme('peachy')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Peachy</span>
        </a>
        
    </div>
    <div class="navitem " id="red-alert">
        <a   onclick="document.body.theme('red-alert')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Red Alert</span>
        </a>
        
    </div>
    <div class="navitem " id="ultra-violet">
        <a   onclick="document.body.theme('ultra-violet')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ultra Violet</span>
        </a>
        
    </div>
    <div class="navitem " id="vintage">
        <a   onclick="document.body.theme('vintage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Vintage</span>
        </a>
        
    </div>
    </div>
    </div>
    </div>
            
    <a class="hamburger">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
        </div>
        
        <div class="layout">
            <div class="sidepane narrow-scrollbars">
                
        <div class="tocmenu">
            <h3>Table of Contents</h3>
            
    <ul>
        
    <li>
        <a href="README.html"><span>🏠</span><span data-toggle="tooltip" data-title="Start here">
            Home
        </span></a>
    </li>
    <li>
        <a href="src/parser.html"><span>👀</span><span data-toggle="tooltip" data-title="Parser implementation">
            Parser
        </span></a>
    </li>
    <li>
        <a href="src/helpers.html"><span>🧰</span><span data-toggle="tooltip" data-title="Helper code">
            Helpers
        </span></a>
    </li>
    <li>
        <a href="src/commonmark.html"><span>🧪</span><span data-toggle="tooltip" data-title="CommonMark tester components">
            Testers
        </span></a>
    </li>
    <li>
        <a href="commonmark-tests.html" class="highlight"><span>M⇩</span><span data-toggle="tooltip" data-title="CommonMark test suite">
            CommonMark Tests
        </span></a>
    </li>
    </ul>
        </div>
                <div class="toc-button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevrons-right" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M7 7l5 5l-5 5" />
            <path d="M13 7l5 5l-5 5" />
        </svg></div>
            </div>
            
        <div class="contentarea closepopups">
            
<h1 id="common-mark-test-suite">CommonMark Test Suite</h1>
<p><commonmark-summary></commonmark-summary></p>
<h2 id="tabs">Tabs</h2>
<p>Tabs in lines are not expanded to spaces. However, in contexts where spaces
help to define block structure, tabs behave as if they were replaced by
spaces with a tab stop of 4 characters.</p>
<p>Thus, for example, a tab can be used instead of four spaces in an indented
code block. (Note, however, that internal tabs are passed through as literal
tabs, not expanded to spaces.)</p>
<p><commonmark-runner examples="1-3,8,10,11"></commonmark-runner></p>
<h2 id="backslash-escapes">Backslash Escapes</h2>
<p>Any ASCII punctuation character may be backslash-escaped:</p>
<p><commonmark-runner examples="12"></commonmark-runner></p>
<p>Backslashes before other characters are treated as literal backslashes:</p>
<p><commonmark-runner examples="13"></commonmark-runner></p>
<p>Escaped characters are treated as regular characters and do not have their usual Markdown meanings:</p>
<p><commonmark-runner examples="14"></commonmark-runner></p>
<p>If a backslash is itself escaped, the following character is not:</p>
<p><commonmark-runner examples="15"></commonmark-runner></p>
<p>A backslash at the end of the line is a hard line break:</p>
<p><commonmark-runner examples="16"></commonmark-runner></p>
<p>Backslash escapes do not work in code blocks, code spans, autolinks, or raw
HTML:</p>
<p><commonmark-runner examples="17-21"></commonmark-runner></p>
<p>But they work in all other contexts, including URLs and link titles, link
references, and info strings in fenced code blocks:</p>
<p><commonmark-runner examples="22-24"></commonmark-runner></p>
<h2 id="entity-and-numeric-character-references">Entity and numeric character references</h2>
<p>Valid HTML entity references and numeric character references can be used in place of the corresponding Unicode character, with the following exceptions:</p>
<ul>
<li>
<p>Entity and character references are not recognized in code blocks and code
spans</p>
</li>
<li>
<p>Entity and character references cannot stand in place of special characters
that define structural elements in CommonMark. For example, although <code>&amp;#42;</code>
can be used in place of a literal <code>*</code> character, <code>&amp;#42;</code> cannot replace <code>*</code>
in emphasis delimiters, bullet list markers, or thematic breaks.</p>
</li>
</ul>
<p>Conforming CommonMark parsers need not store information about whether a particular character was represented in the source using a Unicode character or an entity reference.</p>
<p>Entity references consist of <code>&amp;</code> + any of the valid HTML5 entity names + <code>;</code>.
The document <a href="https://html.spec.whatwg.org/entities.json">https://html.spec.whatwg.org/entities.json</a> is used as an
authoritative source for the valid entity references and their corresponding
code points.</p>
<p><commonmark-runner examples="25"></commonmark-runner></p>
<p>Decimal numeric character references consist of <code>&amp;#</code> + a string of 1–7 arabic
digits + <code>;</code>. A numeric character reference is parsed as the corresponding
Unicode character. Invalid Unicode code points will be replaced by the
REPLACEMENT CHARACTER (U+FFFD). For security reasons, the code point U+0000 will
also be replaced by U+FFFD.</p>
<p><commonmark-runner examples="26"></commonmark-runner></p>
<p>Hexadecimal numeric character references consist of <code>&amp;#</code> + either <code>X</code> or <code>x</code> +
a string of 1-6 hexadecimal digits + <code>;</code>. They too are parsed as the
corresponding Unicode character (this time specified with a hexadecimal numeral
instead of decimal).</p>
<p><commonmark-runner examples="27"></commonmark-runner></p>
<p>Here are some nonentities:</p>
<p><commonmark-runner examples="28"></commonmark-runner></p>
<p>Although HTML5 does accept some entity references without a trailing semicolon
(such as &amp;copy), these are not recognized here, because it makes the grammar too
ambiguous:</p>
<p><commonmark-runner examples="29"></commonmark-runner></p>
<p>Strings that are not on the list of HTML5 named entities are not recognized as
entity references either:</p>
<p><commonmark-runner examples="30"></commonmark-runner></p>
<p>Entity and numeric character references are recognized in any context besides
code spans or code blocks, including URLs, link titles, and fenced code block
info strings:</p>
<p><commonmark-runner examples="31"></commonmark-runner></p>
<p>Entity and numeric character references are treated as literal text in code
spans and code blocks:</p>
<p><commonmark-runner examples="35-36"></commonmark-runner></p>
<p>Entity and numeric character references cannot be used in place of symbols indicating structure in CommonMark documents.</p>
<p><commonmark-runner examples="37-41"></commonmark-runner></p>
<h2 id="blocks-and-inlines">Blocks and Inlines</h2>
<p>We can think of a document as a sequence of blocks—structural elements like
paragraphs, block quotations, lists, headings, rules, and code blocks. Some
blocks (like block quotes and list items) contain other blocks; others (like
headings and paragraphs) contain inline content—text, links, emphasized text,
images, code spans, and so on.</p>
<h3 id="precedence">Precedence</h3>
<p>Indicators of block structure always take precedence over indicators of inline
structure. So, for example, the following is a list with two items, not a list
with one item containing a code span:</p>
<p><commonmark-runner examples="42"></commonmark-runner></p>
<p>This means that parsing can proceed in two steps: first, the block structure of
the document can be discerned; second, text lines inside paragraphs, headings,
and other block constructs can be parsed for inline structure. The second step
requires information about link reference definitions that will be available
only at the end of the first step. Note that the first step requires processing
lines in sequence, but the second can be parallelized, since the inline parsing
of one block element does not affect the inline parsing of any other.</p>
<h3 id="container-blocks-and-leaf-blocks">Container Blocks and Leaf Blocks</h3>
<p>We can divide blocks into two types: container blocks, which can contain other
blocks, and leaf blocks, which cannot.</p>
<h2 id="leaf-blocks">Leaf Blocks</h2>
<p>This section describes the different kinds of leaf block that make up a Markdown
document.</p>
<h3 id="thematic-breaks">Thematic Breaks</h3>
<p>A line consisting of optionally up to three spaces of indentation, followed by a
sequence of three or more matching <code>-</code>, <code>_</code>, or <code>*</code> characters, each followed
optionally by any number of spaces or tabs, forms a thematic break.</p>
<p><commonmark-runner examples="43"></commonmark-runner></p>
<p>Wrong characters:</p>
<p><commonmark-runner examples="44-45"></commonmark-runner></p>
<p>Not enough characters:</p>
<p><commonmark-runner examples="46"></commonmark-runner></p>
<p>Up to three spaces of indentation are allowed:</p>
<p><commonmark-runner examples="47"></commonmark-runner></p>
<p>Four spaces of indentation is too many:</p>
<p><commonmark-runner examples="48-49"></commonmark-runner></p>
<p>More than three characters may be used:</p>
<p><commonmark-runner examples="50"></commonmark-runner></p>
<p>Spaces and tabs are allowed between the characters:</p>
<p><commonmark-runner examples="51-53"></commonmark-runner></p>
<p>Spaces and tabs are allowed at the end:</p>
<p><commonmark-runner examples="54"></commonmark-runner></p>
<p>However, no other characters may occur in the line:</p>
<p><commonmark-runner examples="55"></commonmark-runner></p>
<p>It is required that all of the characters other than spaces or tabs be the same.
So, this is not a thematic break:</p>
<p><commonmark-runner examples="56"></commonmark-runner></p>
<p>Thematic breaks do not need blank lines before or after:</p>
<p><commonmark-runner examples="57"></commonmark-runner></p>
<p>Thematic breaks can interrupt a paragraph:</p>
<p><commonmark-runner examples="58"></commonmark-runner></p>
<p>If a line of dashes that meets the above conditions for being a thematic break
could also be interpreted as the underline of a setext heading, the
interpretation as a setext heading takes precedence. Thus, for example, this is
a setext heading, not a paragraph followed by a thematic break:</p>
<p><commonmark-runner examples="59"></commonmark-runner></p>
<p>If you want a thematic break in a list item, use a different bullet:</p>
<p><commonmark-runner examples="61"></commonmark-runner></p>
<h3 id="atx-headings">ATX headings</h3>
<p>An ATX heading consists of a string of characters, parsed as inline content,
between an opening sequence of 1–6 unescaped <code>#</code> characters and an optional
closing sequence of any number of unescaped <code>#</code> characters. The opening sequence
of <code>#</code> characters must be followed by spaces or tabs, or by the end of line. The
optional closing sequence of <code>#</code>s must be preceded by spaces or tabs and may be
followed by spaces or tabs only. The opening <code>#</code> character may be preceded by up
to three spaces of indentation. The raw contents of the heading are stripped of
leading and trailing space or tabs before being parsed as inline content. The
heading level is equal to the number of <code>#</code> characters in the opening sequence.</p>
<p>Simple headings:</p>
<p><commonmark-runner examples="62"></commonmark-runner></p>
<p>More than six # characters is not a heading:</p>
<p><commonmark-runner examples="63"></commonmark-runner></p>
<p>At least one space or tab is required between the <code>#</code> characters and the
heading’s contents, unless the heading is empty. Note that many implementations
currently do not require the space. However, the space was required by the
original ATX implementation, and it helps prevent things like the following
from being parsed as headings:</p>
<p><commonmark-runner examples="64"></commonmark-runner></p>
<p>This is not a heading, because the first # is escaped:</p>
<p><commonmark-runner examples="65"></commonmark-runner></p>
<p>Contents are parsed as inlines:</p>
<p><commonmark-runner examples="66"></commonmark-runner></p>
<p>Leading and trailing spaces or tabs are ignored in parsing inline content:</p>
<p><commonmark-runner examples="67"></commonmark-runner></p>
<p>Up to three spaces of indentation are allowed:</p>
<p><commonmark-runner examples="68"></commonmark-runner></p>
<p>Four spaces of indentation is too many:</p>
<p><commonmark-runner examples="69-70"></commonmark-runner></p>
<p>ATX headings need not be separated from surrounding content by blank lines, and
they can interrupt paragraphs:</p>
<p><commonmark-runner examples="77-78"></commonmark-runner></p>
<p>ATX headings can be empty:</p>
<p><commonmark-runner examples="79"></commonmark-runner></p>
<h3 id="setext-headings">Setext Headings</h3>
<p>A setext heading consists of one or more lines of text, not interrupted by a
blank line, of which the first line does not have more than 3 spaces of
indentation, followed by a setext heading underline. The lines of text must be
such that, were they not followed by the setext heading underline, they would
be interpreted as a paragraph: they cannot be interpretable as a code fence,
ATX heading, block quote, thematic break, list item, or HTML block.</p>
<p>A setext heading underline is a sequence of <code>=</code> characters or a sequence of <code>-</code>
characters, with no more than 3 spaces of indentation and any number of
trailing spaces or tabs.</p>
<p>The heading is a level 1 heading if <code>=</code> characters are used in the setext
heading underline, and a level 2 heading if <code>-</code> characters are used. The
contents of the heading are the result of parsing the preceding lines of text
as CommonMark inline content.</p>
<p>In general, a setext heading need not be preceded or followed by a blank line.
However, it cannot interrupt a paragraph, so when a setext heading comes after
a paragraph, a blank line is needed between them.</p>
<p>Simple examples:</p>
<p><commonmark-runner examples="80"></commonmark-runner></p>
<p>The content of the header may span more than one line:</p>
<p><commonmark-runner examples="81"></commonmark-runner></p>
<p>The contents are the result of parsing the headings’s raw content as inlines.
The heading’s raw content is formed by concatenating the lines and removing
initial and final spaces or tabs.</p>
<p><commonmark-runner examples="82"></commonmark-runner></p>
<p>The underlining can be any length:</p>
<p><commonmark-runner examples="83"></commonmark-runner></p>
<p>The heading content can be preceded by up to three spaces of indentation, and
need not line up with the underlining:</p>
<p><commonmark-runner examples="84"></commonmark-runner></p>
<p>Four spaces of indentation is too many:</p>
<p><commonmark-runner examples="85"></commonmark-runner></p>
<p>The setext heading underline can be preceded by up to three spaces of
indentation, and may have trailing spaces or tabs:</p>
<p><commonmark-runner examples="86"></commonmark-runner></p>
<p>Four spaces of indentation is too many:</p>
<p><commonmark-runner examples="87"></commonmark-runner></p>
<p>The setext heading underline cannot contain internal spaces or tabs:</p>
<p><commonmark-runner examples="88"></commonmark-runner></p>
<p>Trailing spaces or tabs in the content line do not cause a hard line break:</p>
<p><commonmark-runner examples="89"></commonmark-runner></p>
<p>Nor does a backslash at the end:</p>
<p><commonmark-runner examples="90"></commonmark-runner></p>
<p>Since indicators of block structure take precedence over indicators of inline
structure, the following are setext headings:</p>
<p><commonmark-runner examples="91"></commonmark-runner></p>
<p>A blank line is needed between a paragraph and a following setext heading,
since otherwise the paragraph becomes part of the heading’s content:</p>
<p><commonmark-runner examples="95"></commonmark-runner></p>
<p>But in general a blank line is not required before or after setext headings:</p>
<p><commonmark-runner examples="96"></commonmark-runner></p>
<p>Setext headings cannot be empty:</p>
<p><commonmark-runner examples="97"></commonmark-runner></p>
<p>Setext heading text lines must not be interpretable as block constructs other
than paragraphs. So, the line of dashes in these examples gets interpreted as
a thematic break:</p>
<p><commonmark-runner examples="98-101"></commonmark-runner></p>
<p>If you want a heading with &gt; foo as its literal text, you can use backslash
escapes:</p>
<p><commonmark-runner examples="102"></commonmark-runner></p>
<p><strong>Compatibility note:</strong> Most existing Markdown implementations do not allow the
text of setext headings to span multiple lines. But there is no consensus about
how to interpret</p>
<pre><code>Foo
bar
---
baz
</code></pre>
<p>One can find four different interpretations:</p>
<ol>
<li>paragraph “Foo”, heading “bar”, paragraph “baz”</li>
<li>paragraph “Foo bar”, thematic break, paragraph “baz”</li>
<li>paragraph “Foo bar — baz”</li>
<li>heading “Foo bar”, paragraph “baz”</li>
</ol>
<p>We find interpretation 4 most natural, and interpretation 4 increases the
expressive power of CommonMark, by allowing multiline headings. Authors who
want interpretation 1 can put a blank line after the first paragraph:</p>
<p><commonmark-runner examples="103"></commonmark-runner></p>
<p>Authors who want interpretation 2 can put blank lines around the thematic
break,</p>
<p><commonmark-runner examples="104"></commonmark-runner></p>
<p>or use a thematic break that cannot count as a setext heading underline, such as</p>
<p><commonmark-runner examples="105"></commonmark-runner></p>
<p>Authors who want interpretation 3 can use backslash escapes:</p>
<p><commonmark-runner examples="106"></commonmark-runner></p>
<h3 id="indented-code-blocks">Indented Code Blocks</h3>
<p>An indented code block is composed of one or more indented chunks separated by
blank lines. An indented chunk is a sequence of non-blank lines, each preceded
by four or more spaces of indentation. The contents of the code block are the
literal contents of the lines, including trailing line endings, minus four
spaces of indentation. An indented code block has no info string.</p>
<p>An indented code block cannot interrupt a paragraph, so there must be a blank
line between a paragraph and a following indented code block. (A blank line is
not needed, however, between a code block and a following paragraph.)</p>
<p><commonmark-runner examples="107"></commonmark-runner></p>
<p>If there is any ambiguity between an interpretation of indentation as a code
block and as indicating that material belongs to a list item, the list item
interpretation takes precedence:</p>
<p><commonmark-runner examples="108-109"></commonmark-runner></p>
<p>The contents of a code block are literal text, and do not get parsed as
Markdown:</p>
<p><commonmark-runner examples="110"></commonmark-runner></p>
<p>Here we have three chunks separated by blank lines:</p>
<p><commonmark-runner examples="111"></commonmark-runner></p>
<p>Any initial spaces or tabs beyond four spaces of indentation will be included
in the content, even in interior blank lines:</p>
<p><commonmark-runner examples="112"></commonmark-runner></p>
<p>An indented code block cannot interrupt a paragraph. (This allows hanging
indents and the like.)</p>
<p><commonmark-runner examples="113"></commonmark-runner></p>
<p>However, any non-blank line with fewer than four spaces of indentation ends the
code block immediately. So a paragraph may occur immediately after indented
code:</p>
<p><commonmark-runner examples="114"></commonmark-runner></p>
<p>And indented code can occur immediately before and after other kinds of blocks:</p>
<p><commonmark-runner examples="115"></commonmark-runner></p>
<p>The first line can be preceded by more than four spaces of indentation:</p>
<p><commonmark-runner examples="116"></commonmark-runner></p>
<p>Blank lines preceding or following an indented code block are not included in it:</p>
<p><commonmark-runner examples="117"></commonmark-runner></p>
<p>Trailing spaces or tabs are included in the code block’s content:</p>
<p><commonmark-runner examples="118"></commonmark-runner></p>
<h3 id="fenced-code-blocks">Fenced Code Blocks</h3>
<p>A code fence is a sequence of at least three consecutive backtick characters
<code>`</code> or tildes <code>~</code>. (Tildes and backticks cannot be mixed.) A fenced code
block begins with a code fence, preceded by up to three spaces of indentation.</p>
<p>The line with the opening code fence may optionally contain some text following
the code fence; this is trimmed of leading and trailing spaces or tabs and
called the info string. If the info string comes after a backtick fence, it may
not contain any backtick characters. (The reason for this restriction is that
otherwise some inline code would be incorrectly interpreted as the beginning of
a fenced code block.)</p>
<p>The content of the code block consists of all subsequent lines, until a closing
code fence of the same type as the code block began with (backticks or tildes),
and with at least as many backticks or tildes as the opening code fence. If the
leading code fence is preceded by N spaces of indentation, then up to N spaces
of indentation are removed from each line of the content (if present). (If a
content line is not indented, it is preserved unchanged. If it is indented N
spaces or less, all of the indentation is removed.)</p>
<p>The closing code fence may be preceded by up to three spaces of indentation,
and may be followed only by spaces or tabs, which are ignored. If the end of
the containing block (or document) is reached and no closing code fence has
been found, the code block contains all of the lines after the opening code
fence until the end of the containing block (or document). (An alternative spec
would require backtracking in the event that a closing code fence is not found.
But this makes parsing much less efficient, and there seems to be no real
downside to the behavior described here.)</p>
<p>A fenced code block may interrupt a paragraph, and does not require a blank
line either before or after.</p>
<p>The content of a code fence is treated as literal text, not parsed as inlines.
The first word of the info string is typically used to specify the language of
the code sample, and rendered in the class attribute of the code tag. However,
this spec does not mandate any particular treatment of the info string.</p>
<p>Here is a simple example with backticks:</p>
<p><commonmark-runner examples="119"></commonmark-runner></p>
<p>With tildes:</p>
<p><commonmark-runner examples="120"></commonmark-runner></p>
<p>Fewer than three backticks is not enough:</p>
<p><commonmark-runner examples="121"></commonmark-runner></p>
<p>The closing code fence must use the same character as the opening fence:</p>
<p><commonmark-runner examples="122-123"></commonmark-runner></p>
<p>The closing code fence must be at least as long as the opening fence:</p>
<p><commonmark-runner examples="124-125"></commonmark-runner></p>
<p>Unclosed code blocks are closed by the end of the document (or the enclosing
block quote or list item):</p>
<p><commonmark-runner examples="126-128"></commonmark-runner></p>
<p>A code block can have all empty lines as its content:</p>
<p><commonmark-runner examples="129"></commonmark-runner></p>
<p>A code block can be empty:</p>
<p><commonmark-runner examples="130"></commonmark-runner></p>
<p>Four spaces of indentation is too many:</p>
<p><commonmark-runner examples="134"></commonmark-runner></p>
<p>Closing fences may be preceded by up to three spaces of indentation, and their
indentation need not match that of the opening fence:</p>
<p><commonmark-runner examples="135-136"></commonmark-runner></p>
<p>This is not a closing fence, because it is indented 4 spaces:</p>
<p><commonmark-runner examples="137"></commonmark-runner></p>
<p>Code fences (opening and closing) cannot contain internal spaces or tabs:</p>
<p><commonmark-runner examples="138-139"></commonmark-runner></p>
<p>Fenced code blocks can interrupt paragraphs, and can be followed directly by
paragraphs, without a blank line between:</p>
<p><commonmark-runner examples="140"></commonmark-runner></p>
<p>Other blocks can also occur before and after fenced code blocks without an
intervening blank line:</p>
<p><commonmark-runner examples="141"></commonmark-runner></p>
<p>An info string can be provided after the opening code fence. Although this spec
doesn’t mandate any particular treatment of the info string, the first word is
typically used to specify the language of the code block. In HTML output, the
language is normally indicated by adding a class to the code element consisting
of language- followed by the language name.</p>
<p><commonmark-runner examples="142,144"></commonmark-runner></p>
<p>Info strings for backtick code blocks cannot contain backticks:</p>
<p><commonmark-runner examples="145"></commonmark-runner></p>
<p>Closing code fences cannot have info strings:</p>
<p><commonmark-runner examples="147"></commonmark-runner></p>
<h3 id="html-blocks">HTML blocks</h3>
<p>An HTML block is a group of lines that is treated as raw HTML (and will not be
escaped in HTML output).</p>
<p>There are <s>seven</s> two kinds of HTML block, which can be defined by their start
and end conditions. The block begins with a line that meets a start condition
(after up to three optional spaces of indentation). It ends with the first
subsequent line that meets a matching end condition, or the last line of the
document, or the last line of the container block containing the current HTML
block, if no line is encountered that meets the end condition. If the first
line meets both the start condition and the end condition, the block will
contain just that line.</p>
<ol>
<li>
<p>Start condition: line begins with the string <code>&lt;pre</code>, <code>&lt;script</code>, <code>&lt;style</code>,
or <code>&lt;textarea</code> (case-insensitive), followed by a space, a tab, the string
<code>&gt;</code>, or the end of the line.</p>
<p>End condition: line contains an end tag <code>&lt;/pre&gt;</code>, <code>&lt;/script&gt;</code>, <code>&lt;/style&gt;</code>,
or <code>&lt;/textarea&gt;</code> (case-insensitive; it need not match the start tag).</p>
</li>
<li>
<p>Start condition: line begins with a complete open tag (with any tag name
other than <code>pre</code>, <code>script</code>, <code>style</code>, or <code>textarea</code>) or a complete closing
tag, followed by zero or more spaces and tabs, followed by the end of the
line.</p>
<p>End condition: line is followed by a blank line.</p>
</li>
</ol>
<p>HTML blocks continue until they are closed by their appropriate end condition,
or the last line of the document or other container block. This means any HTML
within an HTML block that might otherwise be recognised as a start condition
will be ignored by the parser and passed through as-is, without changing the
parser’s state.</p>
<p>All types of HTML blocks except type 2 may interrupt a paragraph. (This
restriction is intended to prevent unwanted interpretation of long tags inside
a wrapped paragraph as starting HTML blocks.)</p>
<p>In type 2 blocks, the tag name can be anything:</p>
<p><commonmark-runner examples="163-164"></commonmark-runner></p>
<p>These rules are designed to allow us to work with tags that can function as
either block-level or inline-level tags. The <code>&lt;del&gt;</code> tag is a nice example. We
can surround content with <code>&lt;del&gt;</code> tags in three different ways. In this case,
we get a raw HTML block, because the <code>&lt;del&gt;</code> tag is on a line by itself:</p>
<p><commonmark-runner examples="166"></commonmark-runner></p>
<p>Finally, in this case, the <code>&lt;del&gt;</code> tags are interpreted as raw HTML inside the
CommonMark paragraph. (Because the tag is not on a line by itself, we get
inline HTML rather than an HTML block.)</p>
<p><commonmark-runner examples="168"></commonmark-runner></p>
<p>HTML tags designed to contain literal content (<code>pre</code>, <code>script</code>, <code>style</code>,
<code>textarea</code>), comments, processing instructions, and declarations are treated
somewhat differently. Instead of ending at the first blank line, these blocks
end at the first line containing a corresponding end tag. As a result, these
blocks can contain blank lines:</p>
<p>A <code>pre</code> tag (type 1):</p>
<p><commonmark-runner examples="169"></commonmark-runner></p>
<p>A <code>script</code> tag (type 1):</p>
<p><commonmark-runner examples="170"></commonmark-runner></p>
<p>A <code>textarea</code> tag (type 1):</p>
<p><commonmark-runner examples="171"></commonmark-runner></p>
<p>A <code>style</code> tag (type 1):</p>
<p><commonmark-runner examples="172"></commonmark-runner></p>
<p>If there is no matching end tag, the block will end at the end of the document
(or the enclosing block quote or list item):</p>
<p><commonmark-runner examples="173"></commonmark-runner></p>
<p>The end tag can occur on the same line as the start tag:</p>
<p><commonmark-runner examples="176"></commonmark-runner></p>
<p>Note that anything on the last line after the end tag will be included in the HTML block:</p>
<p><commonmark-runner examples="178"></commonmark-runner></p>
<p>HTML blocks of type 2 cannot interrupt a paragraph:</p>
<p><commonmark-runner examples="187"></commonmark-runner></p>
<h3 id="link-reference-definitions">Link Reference Definitions</h3>
<p>A link reference definition consists of a link label, optionally preceded by up
to three spaces of indentation, followed by a colon (:), optional spaces or
tabs (including up to one line ending), a link destination, optional spaces or
tabs (including up to one line ending), and an optional link title, which if it
is present must be separated from the link destination by spaces or tabs. No
further character may occur.</p>
<p>A link reference definition does not correspond to a structural element of a
document. Instead, it defines a label which can be used in reference links and
reference-style images elsewhere in the document. Link reference definitions
can come either before or after the links that use them.</p>
<p><commonmark-runner examples="192-193"></commonmark-runner></p>
<p><commonmark-runner examples="195"></commonmark-runner></p>
<p>The title may extend over multiple lines:</p>
<p><commonmark-runner examples="196"></commonmark-runner></p>
<p>However, it may not contain a blank line:</p>
<p><commonmark-runner examples="197"></commonmark-runner></p>
<p>The title may be omitted:</p>
<p><commonmark-runner examples="198"></commonmark-runner></p>
<p>The link destination may not be omitted:</p>
<p><commonmark-runner examples="199"></commonmark-runner></p>
<p>However, an empty link destination may be specified using angle brackets:</p>
<p><commonmark-runner examples="200"></commonmark-runner></p>
<p>The title must be separated from the link destination by spaces or tabs:</p>
<p><commonmark-runner examples="201"></commonmark-runner></p>
<p>Both title and destination can contain backslash escapes and literal
backslashes:</p>
<p><commonmark-runner examples="202"></commonmark-runner></p>
<p>A link can come before its corresponding definition:</p>
<p><commonmark-runner examples="203"></commonmark-runner></p>
<p>If there are several matching definitions, the first one takes precedence:</p>
<p><commonmark-runner examples="204"></commonmark-runner></p>
<p>As noted in the section on Links, matching of labels is case-insensitive (see
matches).</p>
<p><commonmark-runner examples="205-206"></commonmark-runner></p>
<p>Whether something is a link reference definition is independent of whether the
link reference it defines is used in the document. Thus, for example, the
following document contains just a link reference definition, and no visible
content:</p>
<p><commonmark-runner examples="207"></commonmark-runner></p>
<p>Here is another one:</p>
<p><commonmark-runner examples="208"></commonmark-runner></p>
<p>This is not a link reference definition, because there are characters other than
spaces or tabs after the title:</p>
<p><commonmark-runner examples="209"></commonmark-runner></p>
<p>This is a link reference definition, but it has no title:</p>
<p><commonmark-runner examples="210"></commonmark-runner></p>
<p>This is not a link reference definition, because it is indented four spaces:</p>
<p><commonmark-runner examples="211"></commonmark-runner></p>
<p>This is not a link reference definition, because it occurs inside a code block:</p>
<p><commonmark-runner examples="212"></commonmark-runner></p>
<p>A link reference definition cannot interrupt a paragraph.</p>
<p><commonmark-runner examples="213"></commonmark-runner></p>
<p>However, it can directly follow other block elements, such as headings and
thematic breaks, and it need not be followed by a blank line.</p>
<p><commonmark-runner examples="214-216"></commonmark-runner></p>
<p>Several link reference definitions can occur one after another, without
intervening blank lines.</p>
<p><commonmark-runner examples="217"></commonmark-runner></p>
<p>Link reference definitions can occur inside block containers, like lists and
block quotations. They affect the entire document, not just the container in
which they are defined:</p>
<p><commonmark-runner examples="218"></commonmark-runner></p>
<h3 id="paragraphs">Paragraphs</h3>
<p>A sequence of non-blank lines that cannot be interpreted as other kinds of
blocks forms a paragraph. The contents of the paragraph are the result of
parsing the paragraph’s raw content as inlines. The paragraph’s raw content is
formed by concatenating the lines and removing initial and final spaces or tabs.</p>
<p>A simple example with two paragraphs:</p>
<p><commonmark-runner examples="219"></commonmark-runner></p>
<p>Paragraphs can contain multiple lines, but no blank lines:</p>
<p><commonmark-runner examples="220"></commonmark-runner></p>
<p>Multiple blank lines between paragraphs have no effect:</p>
<p><commonmark-runner examples="221"></commonmark-runner></p>
<p>Leading spaces or tabs are skipped:</p>
<p><commonmark-runner examples="222"></commonmark-runner></p>
<p>Lines after the first may be indented any amount, since indented code blocks
cannot interrupt paragraphs.</p>
<p><commonmark-runner examples="223"></commonmark-runner></p>
<p>However, the first line may be preceded by up to three spaces of indentation.
Four spaces of indentation is too many:</p>
<p><commonmark-runner examples="224-225"></commonmark-runner></p>
<h3 id="blank-lines">Blank Lines</h3>
<p>Blank lines between block-level elements are ignored, except for the role they
play in determining whether a list is tight or loose.</p>
<p>Blank lines at the beginning and end of the document are also ignored.</p>
<p><commonmark-runner examples="227"></commonmark-runner></p>
<h2 id="container-blocks">Container Blocks</h2>
<p>A container block is a block that has other blocks as its contents. There are
two basic kinds of container blocks: block quotes and list items. Lists are
meta-containers for list items.</p>
<p>We define the syntax for container blocks recursively. The general form of the
definition is:</p>
<p>If X is a sequence of blocks, then the result of transforming X in such-and-such
a way is a container of type Y with these blocks as its content.</p>
<p>So, we explain what counts as a block quote or list item by explaining how these
can be generated from their contents. This should suffice to define the syntax,
although it does not give a recipe for parsing these constructions. (A recipe is
provided below in the section entitled A parsing strategy.)</p>
<h3 id="block-quotes">Block Quotes</h3>
<p>A block quote marker, optionally preceded by up to three spaces of indentation,
consists of (a) the character <code>&gt;</code> together with a following space of
indentation, or (b) a single character <code>&gt;</code> not followed by a space of
indentation.</p>
<p>The following rules define block quotes:</p>
<ol>
<li>
<p><strong>Basic case.</strong> If a string of lines Ls constitute a sequence of blocks
<em>Bs</em>, then the result of prepending a block quote marker to the beginning of
each line in <em>Ls</em> is a block quote containing <em>Bs</em>.</p>
</li>
<li>
<p><strong>Consecutiveness</strong>. A document cannot contain two block quotes in a row
unless there is a blank line between them.</p>
</li>
</ol>
<p>Nothing else counts as a block quote.</p>
<p>Here is a simple example:</p>
<p><commonmark-runner examples="228"></commonmark-runner></p>
<p>The space or tab after the &gt; characters can be omitted:</p>
<p><commonmark-runner examples="229"></commonmark-runner></p>
<p>The &gt; characters can be preceded by up to three spaces of indentation:</p>
<p><commonmark-runner examples="230"></commonmark-runner></p>
<p>Four spaces of indentation is too many:</p>
<p><commonmark-runner examples="231"></commonmark-runner></p>
<p>Laziness is not supported so, all the exceptions work:</p>
<p><commonmark-runner examples="234-237"></commonmark-runner></p>
<p>A block quote can be empty:</p>
<p><commonmark-runner examples="239-240"></commonmark-runner></p>
<p>A block quote can have initial or final blank lines:</p>
<p><commonmark-runner examples="241"></commonmark-runner></p>
<p>A blank line always separates block quotes:</p>
<p><commonmark-runner examples="242"></commonmark-runner></p>
<p>Consecutiveness means that if we put these block quotes together, we get a
single block quote:</p>
<p><commonmark-runner examples="243"></commonmark-runner></p>
<p>To get a block quote with two paragraphs, use:</p>
<p><commonmark-runner examples="244"></commonmark-runner></p>
<p>Block quotes can interrupt paragraphs:</p>
<p><commonmark-runner examples="245"></commonmark-runner></p>
<p>In general, blank lines are not needed before or after block quotes:</p>
<p><commonmark-runner examples="246"></commonmark-runner></p>
<p>More laziness exceptions:</p>
<p><commonmark-runner examples="248-249"></commonmark-runner></p>
<p>When including an indented code block in a block quote, remember that the block
quote marker includes both the <code>&gt;</code> and a following space of indentation. So five
spaces are needed after the <code>&gt;</code>:</p>
<p><commonmark-runner examples="252"></commonmark-runner></p>
<h3 id="list-items">List Items</h3>
<p>A list marker is a bullet list marker or an ordered list marker.</p>
<p>A bullet list marker is a <code>-</code>, <code>+</code>, or <code>*</code> character.</p>
<p>An ordered list marker is a sequence of 1–9 arabic digits (0-9), followed by
either a <code>.</code> character or a <code>)</code> character. (The reason for the length limit is
that with 10 digits we start seeing integer overflows in some browsers.)</p>
<p>The following rules define list items:</p>
<ol>
<li>
<p><strong>Basic case</strong>. If a sequence of lines Ls constitute a sequence of blocks
<em>Bs</em> starting with a character other than a space or tab, and <em>M</em> is a list
marker of width <em>W</em> followed by 1 ≤ <em>N</em> ≤ 4 spaces of indentation, then the
result of prepending <em>M</em> and the following spaces to the first line of <em>Ls</em>,
and indenting subsequent lines of <em>Ls</em> by <em>W</em> + <em>N</em> spaces, is a list item
with <em>Bs</em> as its contents. The type of the list item (bullet or ordered) is
determined by the type of its list marker. If the list item is ordered, then
it is also assigned a start number, based on the ordered list marker.</p>
<p>Exceptions:</p>
<ol>
<li>When the first list item in a list interrupts a paragraph—that is, when
it starts on a line that would otherwise count as paragraph continuation
text—then (a) the lines Ls must not begin with a blank line, and (b) if
the list item is ordered, the start number must be 1.</li>
<li>If any line is a thematic break then that line is not a list item.</li>
</ol>
</li>
</ol>
<p>For example, let <em>Ls</em> be the lines</p>
<p><commonmark-runner examples="253"></commonmark-runner></p>
<p>And let M be the marker 1., and <em>N</em> = 2. Then rule #1 says that the following is
an ordered list item with start number 1, and the same contents as Ls:</p>
<p><commonmark-runner examples="254"></commonmark-runner></p>
<p>The most important thing to notice is that the position of the text after the
list marker determines how much indentation is needed in subsequent blocks in
the list item. If the list marker takes up two spaces of indentation, and there
are three spaces between the list marker and the next character other than a
space or tab, then blocks must be indented five spaces in order to fall under
the list item.</p>
<p>Here are some examples showing how far content must be indented to be put under
the list item:</p>
<p><commonmark-runner examples="255-258"></commonmark-runner></p>
<p>It is tempting to think of this in terms of columns: the continuation blocks
must be indented at least to the column of the first character other than a
space or tab after the list marker. However, that is not quite right. The spaces
of indentation after the list marker determine how much relative indentation is
needed. Which column this indentation reaches will depend on how the list item
is embedded in other constructions, as shown by this example:</p>
<p><commonmark-runner examples="259"></commonmark-runner></p>
<p>Here two occurs in the same column as the list marker <code>1.</code>, but is actually
contained in the list item, because there is sufficient indentation after the
last containing blockquote marker.</p>
<p>The converse is also possible. In the following example, the word <code>two</code> occurs
far to the right of the initial text of the list item, <code>one</code>, but it is not
considered part of the list item, because it is not indented far enough past the
blockquote marker:</p>
<p><commonmark-runner examples="260"></commonmark-runner></p>
<p>Note that at least one space or tab is needed between the list marker and any
following content, so these are not list items:</p>
<p><commonmark-runner examples="261"></commonmark-runner></p>
<p>A list item may contain blocks that are separated by more than one blank line.</p>
<p><commonmark-runner examples="262"></commonmark-runner></p>
<p>A list item may contain any kind of block:</p>
<p><commonmark-runner examples="263"></commonmark-runner></p>
<p>A list item that contains an indented code block will preserve empty lines within the code block verbatim.</p>
<p><commonmark-runner examples="264"></commonmark-runner></p>
<p>Note that ordered list start numbers must be nine digits or less:</p>
<p><commonmark-runner examples="265-266"></commonmark-runner></p>
<p>A start number may begin with 0s:</p>
<p><commonmark-runner examples="267-268"></commonmark-runner></p>
<p>A start number may not be negative:</p>
<p><commonmark-runner examples="269"></commonmark-runner></p>
<ol start="2">
<li>Item starting with indented code. If a sequence of lines <em>Ls</em> constitute a
sequence of blocks <em>Bs</em> starting with an indented code block, and <em>M</em> is a
list marker of width <em>W</em> followed by one space of indentation, then the
result of prepending <em>M</em> and the following space to the first line of <em>Ls</em>,
and indenting subsequent lines of Ls by <em>W</em> + 1 spaces, is a list item with
<em>Bs</em> as its contents. If a line is empty, then it need not be indented. The
type of the list item (bullet or ordered) is determined by the type of its
list marker. If the list item is ordered, then it is also assigned a start
number, based on the ordered list marker.</li>
</ol>
<p>An indented code block will have to be preceded by four spaces of indentation
beyond the edge of the region where text will be included in the list item. In
the following case that is 6 spaces:</p>
<p><commonmark-runner examples="270"></commonmark-runner></p>
<p>And in this case it is 11 spaces:</p>
<p><commonmark-runner examples="271"></commonmark-runner></p>
<p>If the first block in the list item is an indented code block, then by rule #2,
the contents must be preceded by one space of indentation after the list marker:</p>
<p><commonmark-runner examples="272-273"></commonmark-runner></p>
<p>Note that an additional space of indentation is interpreted as space inside the
code block:</p>
<p><commonmark-runner examples="274"></commonmark-runner></p>
<p>Note that rules #1 and #2 only apply to two cases: (a) cases in which the lines
to be included in a list item begin with a character other than a space or tab,
and (b) cases in which they begin with an indented code block. In a case like
the following, where the first block begins with three spaces of indentation,
the rules do not allow us to form a list item by indenting the whole thing and
prepending a list marker:</p>
<p><commonmark-runner examples="275-276"></commonmark-runner></p>
<p>This is not a significant restriction, because when a block is preceded by up to
three spaces of indentation, the indentation can always be removed without a
change in interpretation, allowing rule #1 to be applied. So, in the above case:</p>
<p><commonmark-runner examples="277"></commonmark-runner></p>
<ol start="3">
<li>Item starting with a blank line. If a sequence of lines <em>Ls</em> starting with a
single blank line constitute a (possibly empty) sequence of blocks <em>Bs</em>, and
<em>M</em> is a list marker of width <em>W</em>, then the result of prepending <em>M</em> to the
first line of <em>Ls</em>, and preceding subsequent lines of <em>Ls</em> by <em>W</em> + 1 spaces
of indentation, is a list item with <em>Bs</em> as its contents. If a line is
empty, then it need not be indented. The type of the list item (bullet or
ordered) is determined by the type of its list marker. If the list item is
ordered, then it is also assigned a start number, based on the ordered list
marker.</li>
</ol>
<p>Here are some list items that start with a blank line but are not empty:</p>
<p><commonmark-runner examples="278"></commonmark-runner></p>
<p>When the list item starts with a blank line, the number of spaces following the
list marker doesn’t change the required indentation:</p>
<p><commonmark-runner examples="279"></commonmark-runner></p>
<p>A list item can begin with at most one blank line. In the following example,
<code>foo</code> is not part of the list item:</p>
<p><commonmark-runner examples="280"></commonmark-runner></p>
<p>Here is an empty bullet list item:</p>
<p><commonmark-runner examples="281"></commonmark-runner></p>
<p>It does not matter whether there are spaces or tabs following the list marker:</p>
<p><commonmark-runner examples="282"></commonmark-runner></p>
<p>Here is an empty ordered list item:</p>
<p><commonmark-runner examples="283"></commonmark-runner></p>
<p>A list may start or end with an empty list item:</p>
<p><commonmark-runner examples="284"></commonmark-runner></p>
<p>However, an empty list item cannot interrupt a paragraph:</p>
<p><commonmark-runner examples="285"></commonmark-runner></p>
<ol start="4">
<li>Indentation. If a sequence of lines <em>Ls</em> constitutes a list item according
to rule #1, #2, or #3, then the result of preceding each line of <em>Ls</em> by
up to three spaces of indentation (the same for each line) also
constitutes a list item with the same contents and attributes. If a line
is empty, then it need not be indented.</li>
</ol>
<p>Indented one space:</p>
<p><commonmark-runner examples="286"></commonmark-runner></p>
<p>Indented two spaces:</p>
<p><commonmark-runner examples="287"></commonmark-runner></p>
<p>Indented three spaces:</p>
<p><commonmark-runner examples="288"></commonmark-runner></p>
<p>Four spaces indent gives a code block:</p>
<p><commonmark-runner examples="289"></commonmark-runner></p>
<ol start="5">
<li>That’s all. Nothing that is not counted as a list item by rules #1–4
counts as a list item.</li>
</ol>
<p>The rules for sublists follow from the general rules above. A sublist must be
indented the same number of spaces of indentation a paragraph would need to be
in order to be included in the list item.</p>
<p>So, in this case we need two spaces indent:</p>
<p><commonmark-runner examples="294"></commonmark-runner></p>
<p>Here we need four, because the list marker is wider:</p>
<p><commonmark-runner examples="296"></commonmark-runner></p>
<p>Three is not enough:</p>
<p><commonmark-runner examples="297"></commonmark-runner></p>
<p>A list may be the first block in a list item:</p>
<p><commonmark-runner examples="298-299"></commonmark-runner></p>
<h3 id="lists">Lists</h3>
<p>A list is a sequence of one or more list items of the same type. The list items
may be separated by any number of blank lines.</p>
<p>Two list items are of the same type if they begin with a list marker of the same
type. Two list markers are of the same type if (a) they are bullet list markers
using the same character (<code>-</code>, <code>+</code>, or <code>*</code>) or (b) they are ordered list numbers
with the same delimiter (either <code>.</code> or <code>)</code>).</p>
<p>A list is an ordered list if its constituent list items begin with ordered list
markers, and a bullet list if its constituent list items begin with bullet list
markers.</p>
<p>The start number of an ordered list is determined by the list number of its
initial list item. The numbers of subsequent list items are disregarded.</p>
<p>A list is loose if any of its constituent list items are separated by blank
lines, or if any of its constituent list items directly contain two block-level
elements with a blank line between them. Otherwise a list is tight. (The
difference in HTML output is that paragraphs in a loose list are wrapped in
<code>&lt;p&gt;</code> tags, while paragraphs in a tight list are not.)</p>
<p>Changing the bullet or ordered list delimiter starts a new list:</p>
<p><commonmark-runner examples="301-302"></commonmark-runner></p>
<p>In CommonMark, a list can interrupt a paragraph. That is, no blank line is
needed to separate a paragraph from a following list:</p>
<p><commonmark-runner examples="303"></commonmark-runner></p>
<p>Since it is well established Markdown practice to allow lists to interrupt
paragraphs inside list items, the principle of uniformity requires us to allow
this outside list items as well. (reStructuredText takes a different approach,
requiring blank lines before lists even inside other list items.)</p>
<p>In order to solve the problem of unwanted lists in paragraphs with hard-wrapped
numerals, we allow only lists starting with 1 to interrupt paragraphs. Thus,</p>
<p><commonmark-runner examples="304"></commonmark-runner></p>
<p>We may still get an unintended result in cases like</p>
<p><commonmark-runner examples="305"></commonmark-runner></p>
<p>but this rule should prevent most spurious list captures.</p>
<p>There can be any number of blank lines between items:</p>
<p><commonmark-runner examples="306-307"></commonmark-runner></p>
<p>This is a tight list, because the blank lines are in a code block:</p>
<p><commonmark-runner examples="318"></commonmark-runner></p>
<p>A single-paragraph list is tight:</p>
<p><commonmark-runner examples="322-323"></commonmark-runner></p>
<p>This list is loose, because of the blank line between the two block elements in
the list item:</p>
<p><commonmark-runner examples="324"></commonmark-runner></p>
<h2 id="inlines">Inlines</h2>
<p>Inlines are parsed sequentially from the beginning of the character stream to
the end (left to right, in left-to-right languages). Thus, for example, in</p>
<p><commonmark-runner examples="327"></commonmark-runner></p>
<p><code>hi</code> is parsed as code, leaving the backtick at the end as a literal backtick.</p>
<h3 id="code-spans">Code Spans</h3>
<p>A backtick string is a string of one or more backtick characters (<code>`</code>) that
is neither preceded nor followed by a backtick.</p>
<p>A code span begins with a backtick string and ends with a backtick string of
equal length. The contents of the code span are the characters between these two
backtick strings, normalized in the following ways:</p>
<ul>
<li>First, line endings are converted to spaces.</li>
<li>If the resulting string both begins and ends with a space character, but
does not consist entirely of space characters, a single space character is
removed from the front and back. This allows you to include code that begins
or ends with backtick characters, which must be separated by whitespace from
the opening or closing backtick strings.</li>
</ul>
<p>This is a simple code span:</p>
<p><commonmark-runner examples="328"></commonmark-runner></p>
<p>Here two backticks are used, because the code contains a backtick. This example
also illustrates stripping of a single leading and trailing space:</p>
<p><commonmark-runner examples="329"></commonmark-runner></p>
<p>This example shows the motivation for stripping leading and trailing spaces:</p>
<p><commonmark-runner examples="330"></commonmark-runner></p>
<p>Note that only one space is stripped:</p>
<p><commonmark-runner examples="331"></commonmark-runner></p>
<p>The stripping only happens if the space is on both sides of the string:</p>
<p><commonmark-runner examples="332"></commonmark-runner></p>
<p>Only spaces, and not unicode whitespace in general, are stripped in this way:</p>
<p><commonmark-runner examples="333"></commonmark-runner></p>
<p>Line endings are treated like spaces:</p>
<p><commonmark-runner examples="335-336"></commonmark-runner></p>
<p>Interior spaces are not collapsed:</p>
<p><commonmark-runner examples="337"></commonmark-runner></p>
<p>Note that backslash escapes do not work in code spans. All backslashes are
treated literally:</p>
<p><commonmark-runner examples="338"></commonmark-runner></p>
<p>Backslash escapes are never needed, because one can always choose a string of
<em>n</em> backtick characters as delimiters, where the code does not contain any
strings of exactly <em>n</em> backtick characters.</p>
<p><commonmark-runner examples="339-340"></commonmark-runner></p>
<p>Code span backticks have higher precedence than any other inline constructs
except HTML tags and autolinks. Thus, for example, this is not parsed as
emphasized text, since the second * is part of a code span:</p>
<p><commonmark-runner examples="341"></commonmark-runner></p>
<p>Code spans, HTML tags, and autolinks have the same precedence. Thus, this is
code:</p>
<p><commonmark-runner examples="343"></commonmark-runner></p>
<p>But this is an HTML tag:</p>
<p><commonmark-runner examples="344"></commonmark-runner></p>
<p>And this is code:</p>
<p><commonmark-runner examples="345"></commonmark-runner></p>
<p>But this is an autolink:</p>
<p><commonmark-runner examples="346"></commonmark-runner></p>
<p>When a backtick string is not closed by a matching backtick string, we just have
literal backticks:</p>
<p><commonmark-runner examples="348"></commonmark-runner></p>
<h3 id="emphasis-and-strong-emphasis">Emphasis and Strong Emphasis</h3>
<p>John Gruber’s original Markdown syntax description says:</p>
<p>Markdown treats asterisks (<code>*</code>) and underscores (<code>_</code>) as indicators of emphasis.
Text wrapped with one <code>*</code> or <code>_</code> will be wrapped with an HTML <code>&lt;em&gt;</code> tag; double
<code>*</code>’s or <code>_</code>’s will be wrapped with an HTML <code>&lt;strong&gt;</code> tag.</p>
<p>This is enough for most users, but these rules leave much undecided, especially
when it comes to nested emphasis. The original Markdown.pl test suite makes it
clear that triple <code>***</code> and <code>___</code> delimiters can be used for strong emphasis,
and most implementations have also allowed the following patterns:</p>
<pre><code>***strong emph***
***strong** in emph*
***emph* in strong**
**in strong *emph***
*in emph **strong***
</code></pre>
<p>The following patterns are less widely supported, but the intent is clear and
they are useful (especially in contexts like bibliography entries):</p>
<pre><code>*emph *with emph* in it*
**strong **with strong** in it**
</code></pre>
<p>Many implementations have also restricted intraword emphasis to the <code>*</code> forms,
to avoid unwanted emphasis in words containing internal underscores. (It is best
practice to put these in code spans, but users often do not.)</p>
<pre><code>internal emphasis: foo*bar*baz
no emphasis: foo_bar_baz
</code></pre>
<p>The rules given below capture all of these patterns, while allowing for
efficient parsing strategies that do not backtrack.</p>
<p>First, some definitions. A delimiter run is either a sequence of one or more <code>*</code>
characters that is not preceded or followed by a non-backslash-escaped <code>*</code>
character, or a sequence of one or more <code>_</code> characters that is not preceded or
followed by a non-backslash-escaped <code>_</code> character.</p>
<p>A left-flanking delimiter run is a delimiter run that is (1) not followed by
Unicode whitespace, and either (2a) not followed by a Unicode punctuation
character, or (2b) followed by a Unicode punctuation character and preceded by
Unicode whitespace or a Unicode punctuation character. For purposes of this
definition, the beginning and the end of the line count as Unicode whitespace.</p>
<p>A right-flanking delimiter run is a delimiter run that is (1) not preceded by
Unicode whitespace, and either (2a) not preceded by a Unicode punctuation
character, or (2b) preceded by a Unicode punctuation character and followed by
Unicode whitespace or a Unicode punctuation character. For purposes of this
definition, the beginning and the end of the line count as Unicode whitespace.</p>
<p>Here are some examples of delimiter runs.</p>
<ul>
<li>
<p>left-flanking but not right-flanking:</p>
<pre><code>***abc
_abc
**&quot;abc&quot;
_&quot;abc&quot;
</code></pre>
</li>
<li>
<p>right-flanking but not left-flanking:</p>
<pre><code>abc***
abc_
&quot;abc&quot;**
&quot;abc&quot;_
</code></pre>
</li>
<li>
<p>Both left and right-flanking:</p>
<pre><code>abc***def
&quot;abc&quot;_&quot;def&quot;
</code></pre>
</li>
<li>
<p>Neither left nor right-flanking:</p>
<pre><code>abc *** def
a _ b
</code></pre>
</li>
</ul>
<p>(The idea of distinguishing left-flanking and right-flanking delimiter runs
based on the character before and the character after comes from Roopesh
Chander’s vfmd. vfmd uses the terminology “emphasis indicator string” instead
of “delimiter run,” and its rules for distinguishing left- and right-flanking
runs are a bit more complex than the ones given here.)</p>
<p>The following rules define emphasis and strong emphasis:</p>
<ol>
<li>
<p>A single <code>*</code> character can open emphasis iff (if and only if) it is part of
a left-flanking delimiter run.</p>
</li>
<li>
<p>A single <code>_</code> character can open emphasis iff it is part of a left-flanking
delimiter run and either (a) not part of a right-flanking delimiter run or
(b) part of a right-flanking delimiter run preceded by a Unicode punctuation
character.</p>
</li>
<li>
<p>A single <code>*</code> character can close emphasis iff it is part of a right-flanking
delimiter run.</p>
</li>
<li>
<p>A single <code>_</code> character can close emphasis iff it is part of a right-flanking
delimiter run and either (a) not part of a left-flanking delimiter run or
(b) part of a left-flanking delimiter run followed by a Unicode punctuation
character.</p>
</li>
<li>
<p>A double <code>**</code> can open strong emphasis iff it is part of a left-flanking
delimiter run.</p>
</li>
<li>
<p>A double <code>__</code> can open strong emphasis iff it is part of a left-flanking
delimiter run and either (a) not part of a right-flanking delimiter run or
(b) part of a right-flanking delimiter run preceded by a Unicode punctuation
character.</p>
</li>
<li>
<p>A double <code>**</code> can close strong emphasis iff it is part of a right-flanking
delimiter run.</p>
</li>
<li>
<p>A double <code>__</code> can close strong emphasis iff it is part of a right-flanking
delimiter run and either (a) not part of a left-flanking delimiter run or
(b) part of a left-flanking delimiter run followed by a Unicode punctuation
character.</p>
</li>
<li>
<p>Emphasis begins with a delimiter that can open emphasis and ends with a
delimiter that can close emphasis, and that uses the same character (<code>_</code> or
<code>*</code>) as the opening delimiter. The opening and closing delimiters must
belong to separate delimiter runs. If one of the delimiters can both open
and close emphasis, then the sum of the lengths of the delimiter runs
containing the opening and closing delimiters must not be a multiple of 3
unless both lengths are multiples of 3.</p>
</li>
<li>
<p>Strong emphasis begins with a delimiter that can open strong emphasis and
ends with a delimiter that can close strong emphasis, and that uses the same
character (<code>_</code> or <code>*</code>) as the opening delimiter. The opening and closing
delimiters must belong to separate delimiter runs. If one of the delimiters
can both open and close strong emphasis, then the sum of the lengths of the
delimiter runs containing the opening and closing delimiters must not be a
multiple of 3 unless both lengths are multiples of 3.</p>
</li>
<li>
<p>A literal <code>*</code> character cannot occur at the beginning or end of
<code>*</code>-delimited emphasis or <code>**</code>-delimited strong emphasis, unless it is
backslash-escaped.</p>
</li>
<li>
<p>A literal <code>_</code> character cannot occur at the beginning or end of
<code>_</code>-delimited emphasis or <code>__</code>-delimited strong emphasis, unless it is
backslash-escaped.</p>
</li>
</ol>
<p>Where rules 1–12 above are compatible with multiple parsings, the following
principles resolve ambiguity:</p>
<ol start="13">
<li>
<p>The number of nestings should be minimized. Thus, for example, an
interpretation <code>&lt;strong&gt;</code>...<code>&lt;/strong&gt;</code> is always preferred to
<code>&lt;em&gt;&lt;em&gt;</code>...<code>&lt;/em&gt;&lt;/em&gt;</code>.</p>
</li>
<li>
<p>An interpretation <code>&lt;em&gt;&lt;strong&gt;</code>...<code>&lt;/strong&gt;&lt;/em&gt;</code> is always preferred to
<code>&lt;strong&gt;&lt;em&gt;</code>...<code>&lt;/em&gt;&lt;/strong&gt;</code>.</p>
</li>
<li>
<p>When two potential emphasis or strong emphasis spans overlap, so that the
second begins before the first ends and ends after the first ends, the first
takes precedence. Thus, for example, <code>*foo _bar* baz_</code> is parsed as
<code>&lt;em&gt;foo _bar&lt;/em&gt; baz_</code> rather than <code>*foo &lt;em&gt;bar* baz&lt;/em&gt;</code>.</p>
</li>
<li>
<p>When there are two potential emphasis or strong emphasis spans with the same
closing delimiter, the shorter one (the one that opens later) takes
precedence. Thus, for example, <code>**foo **bar baz**</code> is parsed as
<code>**foo &lt;strong&gt;bar baz&lt;/strong&gt;</code> rather than
<code>&lt;strong&gt;foo **bar baz&lt;/strong&gt;</code>.</p>
</li>
<li>
<p>Inline code spans, links, images, and HTML tags group more tightly than
emphasis. So, when there is a choice between an interpretation that contains
one of these elements and one that does not, the former always wins. Thus,
for example, <code>*[foo*](bar)</code> is parsed as <code>*&lt;a href=&quot;bar&quot;&gt;foo*&lt;/a&gt;</code> rather
than as <code>&lt;em&gt;[foo&lt;/em&gt;](bar)</code>.</p>
</li>
</ol>
<p>These rules can be illustrated through a series of examples.</p>
<p>Rule 1:</p>
<p><commonmark-runner examples="350"></commonmark-runner></p>
<p>This is not emphasis, because the opening <code>*</code> is followed by whitespace, and
hence not part of a left-flanking delimiter run:</p>
<p><commonmark-runner examples="351"></commonmark-runner></p>
<p>This is not emphasis, because the opening <code>*</code> is preceded by an alphanumeric and
followed by punctuation, and hence not part of a left-flanking delimiter run:</p>
<p><commonmark-runner examples="352"></commonmark-runner></p>
<p>Unicode nonbreaking spaces count as whitespace, too:</p>
<p><commonmark-runner examples="353"></commonmark-runner></p>
<p>Unicode symbols count as punctuation, too:</p>
<p><commonmark-runner examples="354"></commonmark-runner></p>
<p>Intraword emphasis with <code>*</code> is permitted:</p>
<p><commonmark-runner examples="355-356"></commonmark-runner></p>
<p>Rule 2:</p>
<p><commonmark-runner examples="357"></commonmark-runner></p>
<p>This is not emphasis, because the opening <code>_</code> is followed by whitespace:</p>
<p><commonmark-runner examples="358"></commonmark-runner></p>
<p>This is not emphasis, because the opening <code>_</code> is preceded by an alphanumeric and
followed by punctuation:</p>
<p><commonmark-runner examples="359"></commonmark-runner></p>
<p>Here <code>_</code> does not generate emphasis, because the first delimiter run is
right-flanking and the second left-flanking:</p>
<p><commonmark-runner examples="363"></commonmark-runner></p>
<p>This is emphasis, even though the opening delimiter is both left- and
right-flanking, because it is preceded by punctuation:</p>
<p><commonmark-runner examples="364"></commonmark-runner></p>
<p>Rule 3:</p>
<p>This is not emphasis, because the closing delimiter does not match the opening
delimiter:</p>
<p><commonmark-runner examples="365"></commonmark-runner></p>
<p>This is not emphasis, because the closing <code>*</code> is preceded by whitespace:</p>
<p><commonmark-runner examples="366"></commonmark-runner></p>
<p>A line ending also counts as whitespace:</p>
<p><commonmark-runner examples="367"></commonmark-runner></p>
<p>This is not emphasis, because the second <code>*</code> is preceded by punctuation and
followed by an alphanumeric (hence it is not part of a right-flanking delimiter
run):</p>
<p><commonmark-runner examples="368"></commonmark-runner></p>
<p>Intraword emphasis with <code>*</code> is allowed:</p>
<p><commonmark-runner examples="370"></commonmark-runner></p>
<p>Rule 4:</p>
<p>This is not emphasis, because the closing <code>_</code> is preceded by whitespace:</p>
<p><commonmark-runner examples="371"></commonmark-runner></p>
<p>This is not emphasis, because the second <code>_</code> is preceded by punctuation and
followed by an alphanumeric:</p>
<p><commonmark-runner examples="372"></commonmark-runner></p>
<p>This is emphasis, even though the closing delimiter is both left- and
right-flanking, because it is followed by punctuation:</p>
<p><commonmark-runner examples="377"></commonmark-runner></p>
<p>Rule 5:</p>
<p><commonmark-runner examples="378"></commonmark-runner></p>
<p>This is not strong emphasis, because the opening delimiter is followed by
whitespace:</p>
<p><commonmark-runner examples="379"></commonmark-runner></p>
<p>Intraword strong emphasis with <code>**</code> is permitted:</p>
<p><commonmark-runner examples="381"></commonmark-runner></p>
<p>Rule 6:</p>
<p><commonmark-runner examples="382"></commonmark-runner></p>
<p>This is not strong emphasis, because the opening delimiter is followed by
whitespace:</p>
<p><commonmark-runner examples="383"></commonmark-runner></p>
<p>A line ending counts as whitespace:</p>
<p><commonmark-runner examples="384"></commonmark-runner></p>
<p>This is strong emphasis, even though the opening delimiter is both left- and
right-flanking, because it is preceded by punctuation:</p>
<p><commonmark-runner examples="390"></commonmark-runner></p>
<p>Rule 7:</p>
<p>This is not strong emphasis, because the closing delimiter is preceded by
whitespace:</p>
<p><commonmark-runner examples="395"></commonmark-runner></p>
<p>Intraword emphasis:</p>
<p><commonmark-runner examples="396"></commonmark-runner></p>
<p>Rule 8:</p>
<p>This is not strong emphasis, because the closing delimiter is preceded by
whitespace:</p>
<p><commonmark-runner examples="403"></commonmark-runner></p>
<p>Rule 9:</p>
<p>Any nonempty sequence of inline elements can be the contents of an emphasized
span.</p>
<p><commonmark-runner examples="404-405"></commonmark-runner></p>
<p>In particular, emphasis and strong emphasis can be nested inside emphasis:</p>
<p><commonmark-runner examples="406-407"></commonmark-runner></p>
<p><commonmark-runner examples="410-411"></commonmark-runner></p>
<p>Note that in the preceding case, the interpretation</p>
<pre><code>&lt;p&gt;&lt;em&gt;foo&lt;/em&gt;&lt;em&gt;bar&lt;em&gt;&lt;/em&gt;baz&lt;/em&gt;&lt;/p&gt;
</code></pre>
<p>is precluded by the condition that a delimiter that can both open and close
(like the <code>*</code> after <code>foo</code>) cannot form emphasis if the sum of the lengths of the
delimiter runs containing the opening and closing delimiters is a multiple of 3
unless both lengths are multiples of 3.</p>
<p>For the same reason, we don’t get two consecutive emphasis sections in this
example:</p>
<p><commonmark-runner examples="412"></commonmark-runner></p>
<p><commonmark-runner examples="414-415"></commonmark-runner></p>
<p>Indefinite levels of nesting are possible:</p>
<p><commonmark-runner examples="418-419"></commonmark-runner></p>
<p>There can be no empty emphasis or strong emphasis:</p>
<p><commonmark-runner examples="420-421"></commonmark-runner></p>
<p>Rule 10:</p>
<p>Any nonempty sequence of inline elements can be the contents of an strongly
emphasized span.</p>
<p><commonmark-runner examples="422-423"></commonmark-runner></p>
<p>In particular, emphasis and strong emphasis can be nested inside strong
emphasis:</p>
<p><commonmark-runner examples="424-425"></commonmark-runner></p>
<p><commonmark-runner examples="427-429"></commonmark-runner></p>
<p><commonmark-runner examples="431"></commonmark-runner></p>
<p>Indefinite levels of nesting are possible:</p>
<p><commonmark-runner examples="432-433"></commonmark-runner></p>
<p>There can be no empty emphasis or strong emphasis:</p>
<p><commonmark-runner examples="434-435"></commonmark-runner></p>
<p>Rule 11:</p>
<p><commonmark-runner examples="436-441"></commonmark-runner></p>
<p>Note that when delimiters do not match evenly, Rule 11 determines that the
excess literal <code>*</code> characters will appear outside of the emphasis, rather than
inside it:</p>
<p><commonmark-runner examples="442"></commonmark-runner></p>
<p><commonmark-runner examples="444-445"></commonmark-runner></p>
<p>Rule 12:</p>
<p><commonmark-runner examples="448-454"></commonmark-runner></p>
<p>Note that when delimiters do not match evenly, Rule 12 determines that the
excess literal <code>_</code> characters will appear outside of the emphasis, rather than
inside it:</p>
<p><commonmark-runner examples="456-457"></commonmark-runner></p>
<p>Rule 13 implies that if you want emphasis nested directly inside emphasis, you
must use different delimiters:</p>
<p><commonmark-runner examples="460-463"></commonmark-runner></p>
<p>Rule 15:</p>
<p><commonmark-runner examples="469-470"></commonmark-runner></p>
<p>Rule 17:</p>
<p><commonmark-runner examples="475-477"></commonmark-runner></p>
<h3 id="links">Links</h3>
<p>A link contains link text (the visible text), a link destination (the URI that
is the link destination), and optionally a link title. There are two basic kinds
of links in Markdown. In inline links the destination and title are given
immediately after the link text. In reference links the destination and title
are defined elsewhere in the document.</p>
<p>A link text consists of a sequence of zero or more inline elements enclosed by
square brackets (<code>[</code> and <code>]</code>). The following rules apply:</p>
<ul>
<li>
<p>Links may not contain other links, at any level of nesting. If multiple
otherwise valid link definitions appear nested inside each other, the
inner-most definition is used.</p>
</li>
<li>
<p>Brackets are allowed in the link text only if (a) they are backslash-escaped
or (b) they appear as a matched pair of brackets, with an open bracket <code>[</code>,
a sequence of zero or more inlines, and a close bracket <code>]</code>.</p>
</li>
<li>
<p>Backtick code spans, autolinks, and raw HTML tags bind more tightly than the
brackets in link text. Thus, for example, <code>[foo`]`</code> could not be a link
text, since the second ] is part of a code span.</p>
</li>
<li>
<p>The brackets in link text bind more tightly than markers for emphasis and
strong emphasis. Thus, for example, <code>*[foo*](url)</code> is a link.</p>
</li>
</ul>
<p>A link destination consists of either</p>
<ul>
<li>
<p>a sequence of zero or more characters between an opening <code>&lt;</code> and a closing
<code>&gt;</code> that contains no line endings or unescaped <code>&lt;</code> or <code>&gt;</code> characters, or</p>
</li>
<li>
<p>a nonempty sequence of characters that does not start with <code>&lt;</code>, does not
include ASCII control characters or space character, and includes
parentheses only if (a) they are backslash-escaped or (b) they are part of
a balanced pair of unescaped parentheses. (Implementations may impose limits
on parentheses nesting to avoid performance issues, but at least three
levels of nesting should be supported.)</p>
</li>
</ul>
<p>A link title consists of either</p>
<ul>
<li>
<p>a sequence of zero or more characters between straight double-quote
characters (<code>&quot;</code>), including a <code>&quot;</code> character only if it is backslash-escaped,
or</p>
</li>
<li>
<p>a sequence of zero or more characters between straight single-quote
characters (<code>'</code>), including a <code>'</code> character only if it is backslash-escaped,
or</p>
</li>
<li>
<p>a sequence of zero or more characters between matching parentheses
(<code>(...)</code>), including a <code>(</code> or <code>)</code> character only if it is backslash-escaped.</p>
</li>
</ul>
<p>Although link titles may span multiple lines, they may not contain a blank line.</p>
<p>An inline link consists of a link text followed immediately by a left
parenthesis <code>(</code>, an optional link destination, an optional link title, and a
right parenthesis <code>)</code>. These four components may be separated by spaces, tabs,
and up to one line ending. If both link destination and link title are present,
they must be separated by spaces, tabs, and up to one line ending.</p>
<p>The link’s text consists of the inlines contained in the link text (excluding
the enclosing square brackets). The link’s URI consists of the link destination,
excluding enclosing <code>&lt;...&gt;</code> if present, with backslash-escapes in effect as
described above. The link’s title consists of the link title, excluding its
enclosing delimiters, with backslash-escapes in effect as described above.</p>
<p>Here is a simple inline link:</p>
<p><commonmark-runner examples="482"></commonmark-runner></p>
<p>The title, the link text and even the destination may be omitted:</p>
<p><commonmark-runner examples="483-487"></commonmark-runner></p>
<p>The destination can only contain spaces if it is enclosed in pointy brackets:</p>
<p><commonmark-runner examples="488-489"></commonmark-runner></p>
<p>The destination cannot contain line endings, even if enclosed in pointy
brackets:</p>
<p><commonmark-runner examples="490-491"></commonmark-runner></p>
<p>The destination can contain <code>)</code> if it is enclosed in pointy brackets:</p>
<p><commonmark-runner examples="492"></commonmark-runner></p>
<p>Pointy brackets that enclose links must be unescaped:</p>
<p><commonmark-runner examples="493"></commonmark-runner></p>
<p>These are not links, because the opening pointy bracket is not matched properly:</p>
<p><commonmark-runner examples="494"></commonmark-runner></p>
<p>Parentheses inside the link destination may be escaped:</p>
<p><commonmark-runner examples="495"></commonmark-runner></p>
<p>However, if you have unbalanced parentheses, you need to escape or use the
<code>&lt;...&gt;</code> form:</p>
<p><commonmark-runner examples="497-499"></commonmark-runner></p>
<p>Parentheses and other symbols can also be escaped, as usual in Markdown:</p>
<p><commonmark-runner examples="500"></commonmark-runner></p>
<p>A link can contain fragment identifiers and queries:</p>
<p><commonmark-runner examples="501"></commonmark-runner></p>
<p>Note that a backslash before a non-escapable character is just a backslash:</p>
<p><commonmark-runner examples="502"></commonmark-runner></p>
<p>URL-escaping should be left alone inside the destination, as all URL-escaped
characters are also valid URL characters. Entity and numerical character
references in the destination will be parsed into the corresponding Unicode code
points, as usual. These may be optionally URL-escaped when written as HTML, but
this spec does not enforce any particular policy for rendering URLs in HTML or
other formats. Renderers may make different decisions about how to escape or
normalize URLs in the output.</p>
<p><commonmark-runner examples="503"></commonmark-runner></p>
<p>Note that, because titles can often be parsed as destinations, if you try to
omit the destination and keep the title, you’ll get unexpected results:</p>
<p><commonmark-runner examples="504"></commonmark-runner></p>
<p>Titles may be in single quotes, double quotes, or parentheses:</p>
<p><commonmark-runner examples="505"></commonmark-runner></p>
<p>Titles must be separated from the link using spaces, tabs, and up to one line
ending. Other Unicode whitespace like non-breaking space doesn’t work.</p>
<p><commonmark-runner examples="507"></commonmark-runner></p>
<p>Nested balanced quotes are not allowed without escaping:</p>
<p><commonmark-runner examples="508"></commonmark-runner></p>
<p>But it is easy to work around this by using a different quote type:</p>
<p><commonmark-runner examples="509"></commonmark-runner></p>
<p>(Note: <code>Markdown.pl</code> did allow double quotes inside a double-quoted title, and
its test suite included a test demonstrating this. But it is hard to see a good
rationale for the extra complexity this brings, since there are already many
ways—backslash escaping, entity and numeric character references, or using a
different quote type for the enclosing title—to write titles containing double
quotes. Markdown.pl’s handling of titles has a number of other strange features.
For example, it allows single-quoted titles in inline links, but not reference
links. And, in reference links but not inline links, it allows a title to begin
with &quot; and end with ). Markdown.pl 1.0.1 even allows titles with no closing
quotation mark, though 1.0.2b8 does not. It seems preferable to adopt a simple,
rational rule that works the same way in inline links and link reference
definitions.)</p>
<p>Spaces, tabs, and up to one line ending is allowed around the destination and
title:</p>
<p><commonmark-runner examples="510"></commonmark-runner></p>
<p>But it is not allowed between the link text and the following parenthesis:</p>
<p><commonmark-runner examples="511"></commonmark-runner></p>
<p>The link text may contain balanced brackets, but not unbalanced ones, unless
they are escaped:</p>
<p><commonmark-runner examples="513-515"></commonmark-runner></p>
<p>The link text may contain inline content:</p>
<p><commonmark-runner examples="516-517"></commonmark-runner></p>
<p>However, links may not contain other links, at any level of nesting.</p>
<p><commonmark-runner examples="518-519"></commonmark-runner></p>
<p>These cases illustrate the precedence of link text grouping over emphasis grouping:</p>
<p><commonmark-runner examples="522"></commonmark-runner></p>
<p>Note that brackets that aren’t part of links do not take precedence:</p>
<p><commonmark-runner examples="523"></commonmark-runner></p>
<p>There are three kinds of reference links: full, collapsed, and shortcut.</p>
<p>A full reference link consists of a link text immediately followed by a link
label that matches a link reference definition elsewhere in the document.</p>
<p>A link label begins with a left bracket (<code>[</code>) and ends with the first right
bracket (<code>]</code>) that is not backslash-escaped. Between these brackets there must
be at least one character that is not a space, tab, or line ending. Unescaped
square bracket characters are not allowed inside the opening and closing square
brackets of link labels. A link label can have at most 999 characters inside the
square brackets.</p>
<p>One label matches another just in case their normalized forms are equal. To
normalize a label, strip off the opening and closing brackets, perform the
Unicode case fold, strip leading and trailing spaces, tabs, and line endings,
and collapse consecutive internal spaces, tabs, and line endings to a single
space. If there are multiple matching reference link definitions, the one that
comes first in the document is used. (It is desirable in such cases to emit a
warning.)</p>
<p>The link’s URI and title are provided by the matching link reference definition.</p>
<p>Here is a simple example:</p>
<p><commonmark-runner examples="527"></commonmark-runner></p>
<p>The rules for the link text are the same as with inline links. Thus:</p>
<p>The link text may contain balanced brackets, but not unbalanced ones, unless
they are escaped:</p>
<p><commonmark-runner examples="529"></commonmark-runner></p>
<p>The link text may contain inline content:</p>
<p><commonmark-runner examples="530-531"></commonmark-runner></p>
<p>However, links may not contain other links, at any level of nesting.</p>
<p><commonmark-runner examples="532-533"></commonmark-runner></p>
<p>(In the examples above, we have two shortcut reference links instead of one full
reference link.)</p>
<p>The following cases illustrate the precedence of link text grouping over
emphasis grouping:</p>
<p><commonmark-runner examples="535"></commonmark-runner></p>
<p>Matching is case-insensitive:</p>
<p><commonmark-runner examples="539"></commonmark-runner></p>
<p>No spaces, tabs, or line endings are allowed between the link text and the link
label:</p>
<p><commonmark-runner examples="542-543"></commonmark-runner></p>
<p>When there are multiple matching link reference definitions, the first is used:</p>
<p><commonmark-runner examples="544"></commonmark-runner></p>
<p>Link labels cannot contain brackets, unless they are backslash-escaped:</p>
<p><commonmark-runner examples="546-549"></commonmark-runner></p>
<p>Note that in this example <code>]</code> is not backslash-escaped:</p>
<p><commonmark-runner examples="550"></commonmark-runner></p>
<p>A link label must contain at least one character that is not a space, tab, or
line ending:</p>
<p><commonmark-runner examples="551"></commonmark-runner></p>
<p>A collapsed reference link consists of a link label that matches a link
reference definition elsewhere in the document, followed by the string <code>[]</code>. The
contents of the link label are parsed as inlines, which are used as the link’s
text. The link’s URI and title are provided by the matching reference link
definition. Thus, <code>[foo][]</code> is equivalent to <code>[foo][foo]</code>.</p>
<p><commonmark-runner examples="553-554"></commonmark-runner></p>
<p>The link labels are case-insensitive:</p>
<p><commonmark-runner examples="555"></commonmark-runner></p>
<p>As with full reference links, spaces, tabs, or line endings are not allowed
between the two sets of brackets:</p>
<p><commonmark-runner examples="556"></commonmark-runner></p>
<p>A shortcut reference link consists of a link label that matches a link reference
definition elsewhere in the document and is not followed by <code>[]</code> or a link
label. The contents of the link label are parsed as inlines, which are used as
the link’s text. The link’s URI and title are provided by the matching link
reference definition. Thus, <code>[foo]</code> is equivalent to <code>[foo][]</code>.</p>
<p><commonmark-runner examples="557-560"></commonmark-runner></p>
<p>The link labels are case-insensitive:</p>
<p><commonmark-runner examples="561"></commonmark-runner></p>
<p>A space after the link text should be preserved:</p>
<p><commonmark-runner examples="562"></commonmark-runner></p>
<p>If you just want bracketed text, you can backslash-escape the opening bracket to
avoid links:</p>
<p><commonmark-runner examples="563"></commonmark-runner></p>
<p>Full and collapsed references take precedence over shortcut references:</p>
<p><commonmark-runner examples="565-566"></commonmark-runner></p>
<p>Inline links also take precedence:</p>
<p><commonmark-runner examples="567"></commonmark-runner></p>
<p>Here, though, <code>[foo][bar]</code> is parsed as a reference, since <code>[bar]</code> is defined:</p>
<p><commonmark-runner examples="570"></commonmark-runner></p>
<h3 id="images">Images</h3>
<p>Syntax for images is like the syntax for links, with one difference. Instead of
link text, we have an image description. The rules for this are the same as for
link text, except that (a) an image description starts with <code>![</code> rather than
<code>[</code>, and (b) an image description may contain links. An image description has
inline elements as its contents. When an image is rendered to HTML, this is
standardly used as the image’s alt attribute.</p>
<p><commonmark-runner examples="572-573"></commonmark-runner></p>
<p><commonmark-runner examples="575"></commonmark-runner></p>
<p>Though this spec is concerned with parsing, not rendering, it is recommended
that in rendering to HTML, only the plain string content of the image
description be used. Note that in the above example, the alt attribute’s value
is foo bar, not foo <code>[bar](/url)</code> or foo <code>&lt;a href=&quot;/url&quot;&gt;bar&lt;/a&gt;</code>. Only the
plain string content is rendered, without formatting.</p>
<p><commonmark-runner examples="576-581"></commonmark-runner></p>
<p>Reference-style:</p>
<p><commonmark-runner examples="582-583"></commonmark-runner></p>
<p>Collapsed:</p>
<p><commonmark-runner examples="584-585"></commonmark-runner></p>
<p>The labels are case-insensitive:</p>
<p><commonmark-runner examples="586"></commonmark-runner></p>
<p>As with reference links, spaces, tabs, and line endings, are not allowed
between the two sets of brackets:</p>
<p><commonmark-runner examples="587"></commonmark-runner></p>
<p>Shortcut:</p>
<p><commonmark-runner examples="588-589"></commonmark-runner></p>
<p>The link labels are case-insensitive:</p>
<p><commonmark-runner examples="591"></commonmark-runner></p>
<p>If you just want a literal ! followed by bracketed text, you can
backslash-escape the opening <code>[</code>:</p>
<p><commonmark-runner examples="592"></commonmark-runner></p>
<p>If you want a link after a literal <code>!</code>, backslash-escape the <code>!</code>:</p>
<p><commonmark-runner examples="593"></commonmark-runner></p>
<h3 id="autolinks">Autolinks</h3>
<p>Autolinks are absolute URIs and email addresses inside <code>&lt;</code> and <code>&gt;</code>. They are
parsed as links, with the URL or email address as the link label.</p>
<p>A URI autolink consists of <code>&lt;</code>, followed by an absolute URI followed by <code>&gt;</code>. It
is parsed as a link to the URI, with the URI as the link’s label.</p>
<p>An absolute URI, for these purposes, consists of a scheme followed by a colon
(<code>:</code>) followed by zero or more characters other than ASCII control characters,
space, <code>&lt;</code>, and <code>&gt;</code>. If the URI includes these characters, they must be
percent-encoded (e.g. <code>%20</code> for a space).</p>
<p>For purposes of this spec, a scheme is any sequence of 2–32 characters beginning
with an ASCII letter and followed by any combination of ASCII letters, digits,
or the symbols plus (“+”), period (“.”), or hyphen (“-”).</p>
<p>Here are some valid autolinks:</p>
<p><commonmark-runner examples="594-596"></commonmark-runner></p>
<p>Uppercase is also fine:</p>
<p><commonmark-runner examples="597"></commonmark-runner></p>
<p>Note that many strings that count as absolute URIs for purposes of this spec are
not valid URIs, because their schemes are not registered or because of other
problems with their syntax:</p>
<p><commonmark-runner examples="598-601"></commonmark-runner></p>
<p>Spaces are not allowed in autolinks:</p>
<p><commonmark-runner examples="602"></commonmark-runner></p>
<p>Backslash-escapes do not work inside autolinks:</p>
<p><commonmark-runner examples="603"></commonmark-runner></p>
<p>An email autolink consists of <code>&lt;</code>, followed by an email address, followed by
<code>&gt;</code>. The link’s label is the email address, and the URL is <code>mailto:</code> followed by
the email address.</p>
<p>An email address, for these purposes, is anything that matches the non-normative
regex from the HTML5 spec:</p>
<pre><code>/^[a-zA-Z0-9.!#$%&amp;'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?
(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/
</code></pre>
<p>Examples of email autolinks:</p>
<p><commonmark-runner examples="604-605"></commonmark-runner></p>
<p>Backslash-escapes do not work inside email autolinks:</p>
<p><commonmark-runner examples="606"></commonmark-runner></p>
<p>These are not autolinks:</p>
<p><commonmark-runner examples="607-612"></commonmark-runner></p>
<h3 id="raw-html">Raw HTML</h3>
<p>Text between <code>&lt;</code> and <code>&gt;</code> that looks like an HTML tag is parsed as a raw HTML tag
and will be rendered in HTML without escaping. Tag and attribute names are not
limited to current HTML tags, so custom tags (and even, say, DocBook tags) may
be used.</p>
<p>Here is the grammar for tags:</p>
<p>A tag name consists of an ASCII letter followed by zero or more ASCII letters,
digits, or hyphens (-).</p>
<p>An attribute consists of spaces, tabs, and up to one line ending, an attribute
name, and an optional attribute value specification.</p>
<p>An attribute name consists of an ASCII letter, <code>_</code>, or <code>:</code>, followed by zero or
more ASCII letters, digits, <code>_</code>, <code>.</code>, <code>:</code>, or <code>-</code>. (Note: This is the XML
specification restricted to ASCII. HTML5 is laxer.)</p>
<p>An attribute value specification consists of optional spaces, tabs, and up to
one line ending, a <code>=</code> character, optional spaces, tabs, and up to one line
ending, and an attribute value.</p>
<p>An attribute value consists of an unquoted attribute value, a single-quoted
attribute value, or a double-quoted attribute value.</p>
<p>An unquoted attribute value is a nonempty string of characters not including
spaces, tabs, line endings, <code>&quot;</code>, <code>'</code>, <code>=</code>, <code>&lt;</code>, <code>&gt;</code>, or <code>`</code>.</p>
<p>A single-quoted attribute value consists of <code>'</code>, zero or more characters not
including <code>'</code>, and a final <code>'</code>.</p>
<p>A double-quoted attribute value consists of <code>&quot;</code>, zero or more characters not
including <code>&quot;</code>, and a final <code>&quot;</code>.</p>
<p>An open tag consists of a <code>&lt;</code> character, a tag name, zero or more attributes,
optional spaces, tabs, and up to one line ending, an optional <code>/</code> character,
and a <code>&gt;</code> character.</p>
<p>A closing tag consists of the string <code>&lt;/</code>, a tag name, optional spaces, tabs,
and up to one line ending, and the character <code>&gt;</code>.</p>
<p>An HTML tag consists of an open tag, and a closing tag.</p>
<p>Here are some simple open tags:</p>
<p><commonmark-runner examples="613"></commonmark-runner></p>
<p>Empty elements:</p>
<p><commonmark-runner examples="614"></commonmark-runner></p>
<p>Whitespace is allowed:</p>
<p><commonmark-runner examples="615"></commonmark-runner></p>
<p>With attributes:</p>
<p><commonmark-runner examples="616"></commonmark-runner></p>
<p>Custom tag names can be used:</p>
<p><commonmark-runner examples="617"></commonmark-runner></p>
<p>Illegal tag names, not parsed as HTML:</p>
<p><commonmark-runner examples="618"></commonmark-runner></p>
<p>Illegal attribute names:</p>
<p><commonmark-runner examples="619"></commonmark-runner></p>
<p>Illegal attribute values:</p>
<p><commonmark-runner examples="620"></commonmark-runner></p>
<p>Illegal whitespace:</p>
<p><commonmark-runner examples="621"></commonmark-runner></p>
<p>Missing whitespace:</p>
<p><commonmark-runner examples="622"></commonmark-runner></p>
<p>Closing tags:</p>
<p><commonmark-runner examples="623"></commonmark-runner></p>
<p>Illegal attributes in closing tag:</p>
<p><commonmark-runner examples="624"></commonmark-runner></p>
<p>Entity and numeric character references are preserved in HTML attributes:</p>
<p><commonmark-runner examples="630"></commonmark-runner></p>
<p>Backslash escapes do not work in HTML attributes:</p>
<p><commonmark-runner examples="631-632"></commonmark-runner></p>
<h3 id="hard-line-breaks">Hard Line Breaks</h3>
<p>A line ending (not in a code span or HTML tag) that is preceded by two or more
spaces and does not occur at the end of a block is parsed as a hard line break
(rendered in HTML as a <code>&lt;br&gt;</code> tag):</p>
<p>For a more visible alternative, a backslash before the line ending may be used
instead of two or more spaces:</p>
<p><commonmark-runner examples="634"></commonmark-runner></p>
<p>Leading spaces at the beginning of the next line are ignored:</p>
<p><commonmark-runner examples="637"></commonmark-runner></p>
<p>Hard line breaks can occur inside emphasis, links, and other constructs that
allow inline content:</p>
<p><commonmark-runner examples="639"></commonmark-runner></p>
<p>Hard line breaks do not occur inside code spans</p>
<p><commonmark-runner examples="641"></commonmark-runner></p>
<p>or HTML tags:</p>
<p><commonmark-runner examples="643"></commonmark-runner></p>
<p>Hard line breaks are for separating inline content within a block. Neither
syntax for hard line breaks works at the end of a paragraph or other block
element:</p>
<p><commonmark-runner examples="644,646"></commonmark-runner></p>
<h3 id="soft-line-breaks">Soft Line Breaks</h3>
<p>A regular line ending (not in a code span or HTML tag) that is not preceded by
two or more spaces or a backslash is parsed as a softbreak. (A soft line break
may be rendered in HTML either as a line ending or as a space. The result will
be the same in browsers. In the examples here, a line ending will be used.)</p>
<p><commonmark-runner examples="648"></commonmark-runner></p>
<p>Spaces at the end of the line and beginning of the next line are removed:</p>
<p><commonmark-runner examples="649"></commonmark-runner></p>
<p>A conforming parser may render a soft line break in HTML either as a line ending
or as a space.</p>
<p>A renderer may also provide an option to render soft line breaks as hard line
breaks.</p>
<h3 id="textual-content">Textual Content</h3>
<p>Any characters not given an interpretation by the above rules will be parsed as
plain textual content.</p>
<p><commonmark-runner examples="650-651"></commonmark-runner></p>
<p>Internal spaces are preserved verbatim:</p>
<p><commonmark-runner examples="652"></commonmark-runner></p>

        </div>
            <div class="sidepane narrow-scrollbars">
                
        <div class="pagemenu">
            <h3>On This Page</h3>
                <ul class="pagetree">
                </ul>
        </div>
            </div>
        </div>
        
        <div class="footer">
            <a class="footer-button" href="src/commonmark.html">
            <p>Previous</p>
            <p>« Testers</p>
        </a>
            <div class="footer-text">
                <p>Copyright © 2025 Tommi Johtela</p>
                <p>Generated by 
                    <a href="https://johtela.github.io/litscript">LiTScript</a>
                </p>
            </div>
            <a class="footer-button disabled">
            Next
        </a>
        </div>
    
        <script src="dist/normal.js"></script>
<script src="dist/commonmark.js"></script>
    </body>
    </html>